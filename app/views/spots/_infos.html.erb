<div class="card">
  <div class="image-container">
    <%= cl_image_tag(@spot.photos.attached? ? @spot.photos.first.key : "default_photo", crop: :fill, class: 'img-fluid') %>
  </div>
  <div class="card-body">
    <div>
      <strong>Description:</strong> <%= @spot.description %>
    </div>
    <div>
      <strong>Wave type:</strong> <%= @spot.wave_type %>
    </div>
    <div>
      <strong>Difficulty:</strong> <%= @spot.difficulty %>
    </div>
  </div>
  <i class="bi bi-camera-reels-fill" data-bs-toggle="modal" data-bs-target="#videoModal"></i>
</div>

<div class="modal fade" id="videoModal" tabindex="-1" aria-labelledby="videoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
      <div class="video-player-component">
        <div class="video-player-container loading"
          data-controller="video-player"
          data-video-player-url-value="<%= @url %>">
          <div data-video-player-target="player"></div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
  </div>
</div>

<div class="weather-infos" data-controller="weather-infos-scroll">
  <div class="infos card" data-action="scroll->weather-infos-scroll#scroll" data-weather-infos-scroll-target="details">
    <% @hours.each do |value| %>
      <div class="info">
        <%= value %>h
      </div>
    <% end %>
  </div>
  <% @weather_data.each do |key, data| %>
    <div class="card">
      <h5 class="card-title info-title"><%= key.to_s.gsub('_', ' ').capitalize %></h5>
      <div class="infos" data-action="scroll->weather-infos-scroll#scroll" data-weather-infos-scroll-target="details">
        <% data.each_with_index do |value, index| %>
          <div class="info">
            <% if key === 'cloud_cover' %>
              <i class="fa-solid <%= value > 66 ? "fa-cloud" : (value < 33 ? "fa-sun" : "fa-cloud-sun")%>"></i>
            <% elsif key === 'swell_period' %>
              <%= value.round %>s
            <% elsif key === 'swell_direction' %>
              <%= image_tag "north-arrow.svg", style: "transform: rotate(#{value}deg); width: 18px" %>
            <% elsif key === 'wave_height' %>
              <%= value %>m
            <% elsif key === 'sea_level' %>
              <%= (value * -100).round %>%
            <% elsif key === 'current' %>
              <%= image_tag "north-arrow.svg", style: "transform: rotate(#{value[0]}deg); width: 18px" %>
              <%= value[1] %>
            <% elsif key === 'wind' %>
              <%= image_tag "north-arrow.svg", style: "transform: rotate(#{value[0]}deg); width: 18px" %>
              <%= value[1] %>
            <% elsif key === 'water_temperature' %>
              <%= value.round %>Â°C
            <% else %>
              <%= value %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
